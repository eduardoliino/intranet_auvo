{% extends "base.html" %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
    <h2 class="mb-0">Configurações do Organograma</h2>
    <a href="{{ url_for('colaborador.listar') }}" class="btn btn-secondary">Voltar para Colaboradores</a>
</div>

<div class="card mb-4">
    <div class="card-header fw-bold">Definir Raiz do Organograma (CEO)</div>
    <div class="card-body">
        <form method="POST" action="{{ url_for('admin.gerenciar_cargos_departamentos') }}">
            <input type="hidden" name="form_ceo" value="1">
            <div class="mb-3">
                <label for="ceo_id" class="form-label">Selecione o colaborador que estará no topo do organograma:</label>
                <select id="ceo_id" name="ceo_id" class="form-select custom-select">
                    <option value="">Ninguém definido</option>
                    {% for col in colaboradores %}
                        <option value="{{ col.id }}" {% if col.id == ceo_id %}selected{% endif %}>
                            {{ col.nome }} {{ col.sobrenome }}
                        </option>
                    {% endfor %}
                </select>
            </div>
            <button type="submit" class="btn btn-auvo">Salvar CEO</button>
        </form>
    </div>
</div>

<div class="row">
    <div class="col-md-6">
        <div class="card">
            <div class="card-header fw-bold">Gerenciar Cargos</div>
            <div class="card-body">
                <form method="POST" action="{{ url_for('admin.gerenciar_cargos_departamentos') }}" class="mb-4 p-3 border rounded">
                    <input type="hidden" name="form_cargo" value="1">
                    <h6 class="mb-3">Adicionar Novo Cargo</h6>
                    <div class="mb-2"><label class="form-label">Título</label><input type="text" name="titulo" class="form-control" required></div>
                    <div class="mb-3"><label class="form-label">Descrição</label><textarea name="descricao" class="form-control" rows="2"></textarea></div>
                    <button type="submit" class="btn btn-success w-100">Adicionar Cargo</button>
                </form>
                <h6 class="mt-4">Cargos Existentes</h6>
                <ul class="list-group">
                    {% for cargo in cargos %}
                    <li class="list-group-item">{{ cargo.titulo }}</li>
                    {% else %}
                    <li class="list-group-item text-muted">Nenhum cargo cadastrado.</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>
    <div class="col-md-6">
        <div class="card">
            <div class="card-header fw-bold">Gerenciar Departamentos</div>
            <div class="card-body">
                 <form method="POST" action="{{ url_for('admin.gerenciar_cargos_departamentos') }}" class="mb-4 p-3 border rounded">
                    <input type="hidden" name="form_depto" value="1">
                    <h6 class="mb-3">Adicionar Novo Departamento</h6>
                    <div class="mb-2"><label class="form-label">Nome</label><input type="text" name="nome" class="form-control" required></div>
                    <div class="mb-3"><label class="form-label">Cor</label><input type="color" name="cor" class="form-control form-control-color" value="#7A28B8"></div>
                    <button type="submit" class="btn btn-success w-100">Adicionar Departamento</button>
                </form>
                <h6 class="mt-4">Departamentos Existentes</h6>
                <ul class="list-group">
                    {% for depto in departamentos %}
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        {{ depto.nome }}
                        <span style="width: 20px; height: 20px; border-radius: 5px; background-color: {{ depto.cor }};"></span>
                    </li>
                    {% else %}
                    <li class="list-group-item text-muted">Nenhum departamento cadastrado.</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>
</div>
{% endblock %}